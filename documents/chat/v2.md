# Banddy 채팅 가이드 v2

v2에서는 다음 변경점을 반영합니다.

- 그룹/개인 전송 목적지 분리
  - GROUP: `/app/chat/group.sendMessage/{roomId}`
  - PRIVATE: `/app/chat/private.sendMessage/{roomId}` (receiverId 필수)
- `ChatPage` 실사용 연동
  - URL 쿼리로 입장: `/home/chat?roomId=42&roomType=GROUP`
  - 개인: `/home/chat?roomId=43&roomType=PRIVATE&receiverId=5`
- STOMP CONNECT 헤더 동일
  - Authorization에는 액세스 토큰 문자열 그대로
- 구독 경로 동일
  - 그룹: `/topic/room/{roomId}`
  - 개인: `/user/queue/room/{roomId}`
  - 안읽음: `/user/queue/unread`

## 사용 예시 업데이트

- 전송 예시(GROUP)
```json
{
  "content": "안녕하세요!",
  "roomType": "GROUP"
}
```

- 전송 예시(PRIVATE)
```json
{
  "content": "안녕하세요!",
  "roomType": "PRIVATE",
  "receiverId": 5
}
```

## 클라이언트 매핑 업데이트

- `src/constants/index.ts`
  - `WEBSOCKET.SEND_MESSAGE_GROUP(roomId)`
  - `WEBSOCKET.SEND_MESSAGE_PRIVATE(roomId)`
- `src/services/WebSocketService.ts`
  - `sendMessage()`가 `roomType`으로 목적지 선택
- `src/pages/chat/ChatPage.tsx`
  - 쿼리스트링에서 `roomId`, `roomType`, `receiverId`를 읽어 자동 입장/전송

## 테스트 체크리스트
- 두 브라우저에서 `/home/chat?roomId=42&roomType=GROUP` 진입 → 양방향 수신 확인
- 개인방이 존재할 경우 `/home/chat?roomId=43&roomType=PRIVATE&receiverId=<상대>` 진입 → 큐 수신 확인
- `/user/queue/unread`는 목록 화면에서 접속 시 구독하여 실시간 카운팅(향후 스토어 연동)


